# hou.labels.folders

Windows PowerShell script to create folder labels from ArchivesSpace EAD files for Houghton Library, Harvard University.

## Required files
* hou.labels.folders.bat (only needed if workstation permissions restrict PowerShell scripts)
* hou.labels.folders.dotx (folder label Word template with mail merge fields)
* hou.labels.folders.ps1 (Windows PowerShell script to run process)
* hou.labels.folders.xsl (XSLT to transform ArchivesSpace EAD to TSV for the mail merge)

## Other files
* hou.labels.folders.tsv (generated by the XSLT transform; not required for set-up and can be deleted)

## Set-up
1. Unzip hou.labels.folders.zip to the location where you want to run the script.
   * Unzip to a folder named "hou.labels.folders".
   * All files must be in the same location with their original names.
1. Create a shortcut for the hou.labels.folders.bat if you would like to run the script from another location.
1. Place the shortcut in your preferred location.

## Running the script
1. Download a resource EAD file from ArchivesSpace.
1. Double-click on hou.labels.folders.bat (or the shortcut to this batch file).
1. Select the downloaded EAD file from the file picker window. (The window may be hidden behind other open windows.)
1. If a "Header Record Delimiters" message box appears in Word, click "OK" and script should continue.
1. Review the generated labels in Word and edit as needed.
1. Print the labels.

## For extensive label editing
1. Double click on hou.labels.folder.dotx to re-open the last created label template.
1. Click "Yes" for the warning dialog box that begins "Opening this document with run the following SQL command ..."
1. Click on the "Mailings" tab.
   * To sort labels or remove records, click on "Edit Recipient List", make changes, and click "OK".
   * To change the formatting, edit the formatting in the first cell on the page.
1. Apply results by clicking "Update Labels" and then "Preview Results".
1. Select "Finish & Merge" > "Edit Individual Documents" to generate labels for printing.

## Functions
1. BAT script launches PowerShell script without administrative privileges in a minimized window.
1. PowerShell (PS) script displays a file picker dialog box to get EAD XML file. If no file is selected, the script exits.
1. PS script transforms EAD XML to TSV with an XSLT file. (XSLT file modified from a file originally created by Yale University.) If TSV has 0 or 1 row(s), meaning the XSLT failed, script shows an error message and exits.
1. PS script performs a mail merge in Word using the TSV file, opening a Word mail merge template document and a document of fully merged labels.
1. PS script closes the Word template window for the mail merge.

## Development history
Created: 2017-08-03 by Vernica M. Downey

Created in and for Windows PowerShell v.3.0, Microsoft Word 2010, Windows 7
