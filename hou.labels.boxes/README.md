# hou.labels.boxes

Windows PowerShell script to create box labels from ArchivesSpace container label export (TSV) files for Houghton Library, Harvard University.

## Required files
* hou.labels.boxes.bat (only needed if workstation permissions restrict PowerShell scripts)
* hou.labels.boxes.dotx (box label Word template with mail merge fields)
* hou.labels.boxes.ps1 (Windows PowerShell script to run process)

## Other files
* hou.labels.boxes.tsv (generated by script; not required for set-up and can be deleted)

## Set-up
1. Unzip hou.labels.boxes.zip to the location where you want to run the script.
    * Files must be unzipped to a folder named "hou.labels.boxes". 
    * All files must be in the same location with their original names.
1. Create a shortcut for the hou.labels.boxes.bat if you would like to run the script from another location.
1. Place the shortcut in your preferred location.

## Running the script

1. Download a container label file from a resource in ArchivesSpace.
1. Double-click on hou.labels.boxes.bat (or the shortcut to this batch file).
1. Select the downloaded label file from the file picker window. (The window may be hidden behind other open windows.)
1. If a "Header Record Delimiters" message box appears in Word, click "OK" and script should continue.
1. If an "MailMerge Errors" document window appears with the text "Record x was an empty record," close the window.
1. Review the generated labels in Word and edit as needed.
1. Print the labels.

## For extensive label editing
1. Double click on hou.labels.boxes.dotx to re-open the last created label template.
1. Click "Yes" for the warning dialog box that begins "Opening this document with run the following SQL command ..."
1. Click on the "Mailings" tab.
   * To sort labels or remove records, click on "Edit Recipient List", make changes, and click "OK".
   * To change the formatting, edit the formatting in the first cell on the page.
1. Apply results by clicking "Update Labels" and then "Preview Results".
1. Select "Finish & Merge" > "Edit Individual Documents" to generate labels for printing.

## Functions

1. BAT script launches PowerShell script without administrative privileges in a minimized window.
1. PowerShell (PS) script displays a file picker dialog box to get a container labels TSV file. If no file is selected, the script exits.
1. If TSV has 0 or 1 row(s), meaning ArchivesSpace only output the header row, script shows an error message and exits.
1. Otherwise, PS script copies the data from the selected file to hou.labels.boxes.
   * Script removes a stray tab supplied by ArchivesSpace between "Container" and "Label" in the header row.
   * Script also attempts to repair improperly formatted files by supplying newlines before the "Repository Name" value. 
1. PS script performs a mail merge in Word using the TSV file, opening a Word mail merge template document and a document of fully merged labels.
1. PS script closes the Word template window for the mail merge.


## Development history

Created: 2017-08-08 by Vernica M. Downey

Created in and for Windows PowerShell v.3.0, Microsoft Word 2010, Windows 7
